SELECT
	CDV_ITU_TOPUP_TRANSACTION.PARTNER_NAME ,
	CDV_ITU_TOPUP_TRANSACTION.PROVIDER ,
	COUNT (
		CDV_ITU_TOPUP_TRANSACTION.REQUEST_ID
	) COUNT_UPDATE,
	TO_CHAR (
		CDV_ITU_TOPUP_TRANSACTION.TIME_UPDATE,
		'YYYYMMDD'
	) DAY_TRANSACTION,
	TO_CHAR (
		CDV_ITU_TOPUP_TRANSACTION.TIME_UPDATE,
		'YYYYMM'
	) MONTH_TRANSACTION,
	CDV_ITU_TOPUP_TRANSACTION.COMMISSION * 100 RATE,
	CDV_ITU_TOPUP_TRANSACTION.AMOUNT
VALUE
	,
	SUM (
		CDV_ITU_TOPUP_TRANSACTION.AMOUNT
	) AMOUNT_UPDATE
FROM
	CDV_ITU_TOPUP_TRANSACTION
WHERE
	1 = 1
AND CDV_ITU_TOPUP_TRANSACTION.TYPE_PROCESS IN ('1')
AND CDV_ITU_TOPUP_TRANSACTION.STATUS IN ('0')
AND TO_CHAR (
	CDV_ITU_TOPUP_TRANSACTION.TIME_UPDATE,
	'YYYYMMDD'
) > TO_CHAR (RESPONSE_TIME, 'YYYYMMDD')
AND TO_CHAR (
	CDV_ITU_TOPUP_TRANSACTION.RESPONSE_TIME,
	'YYYYMMDD'
) >= TO_CHAR (SYSDATE - 30, 'YYYYMMDD')
AND TO_CHAR (
	CDV_ITU_TOPUP_TRANSACTION.TIME_UPDATE,
	'YYYYMMDD'
) <= '20170101'
AND TO_CHAR (
	CDV_ITU_TOPUP_TRANSACTION.TIME_UPDATE,
	'YYYYMMDD'
) >= '20170101'   and CDV_ITU_TOPUP_TRANSACTION.PARTNER_NAME ='hdcvietnam' and CDV_ITU_TOPUP_TRANSACTION.PROVIder = 'VTT'   and CDV_ITU_TOPUP_TRANSACTION.AMOUNT = 100000

GROUP BY
	CDV_ITU_TOPUP_TRANSACTION.PARTNER_NAME,
	CDV_ITU_TOPUP_TRANSACTION.PROVIDER,
	TO_CHAR (
		CDV_ITU_TOPUP_TRANSACTION.TIME_UPDATE,
		'YYYYMMDD'
	),
	TO_CHAR (
		CDV_ITU_TOPUP_TRANSACTION.TIME_UPDATE,
		'YYYYMM'
	),
	CDV_ITU_TOPUP_TRANSACTION.COMMISSION * 100,
	CDV_ITU_TOPUP_TRANSACTION.AMOUNT 